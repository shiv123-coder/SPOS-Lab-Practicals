package Scheduling;

import java.util.*;

/**
 * Represents a process with necessary scheduling attributes.
 */
class FCFSProcess {
    private String processId;
    private int arrivalTime;
    private int burstTime;
    private int waitingTime;
    private int turnaroundTime;

    // Constructor
    public FCFSProcess(String processId, int arrivalTime, int burstTime) {
        this.processId = processId;
        this.arrivalTime = arrivalTime;
        this.burstTime = burstTime;
    }

    // Getters
    public String getProcessId() {
        return processId;
    }

    public int getArrivalTime() {
        return arrivalTime;
    }

    public int getBurstTime() {
        return burstTime;
    }

    public int getWaitingTime() {
        return waitingTime;
    }

    public int getTurnaroundTime() {
        return turnaroundTime;
    }

    // Setters
    public void setWaitingTime(int waitingTime) {
        this.waitingTime = waitingTime;
    }

    public void setTurnaroundTime(int turnaroundTime) {
        this.turnaroundTime = turnaroundTime;
    }
}

/**
 * Scheduler class implementing FCFS algorithm logic.
 */
class Scheduler {

    // Method to calculate Waiting and Turnaround times
    public void calculateFCFS(List<FCFSProcess> processes) {

        // Sort processes by arrival time (FCFS order)
        processes.sort(Comparator.comparingInt(FCFSProcess::getArrivalTime));

        int currentTime = 0;

        for (FCFSProcess p : processes) {
            // If CPU is idle before the process arrives
            if (currentTime < p.getArrivalTime()) {
                currentTime = p.getArrivalTime();
            }

            // Calculate waiting and turnaround times
            int waitingTime = currentTime - p.getArrivalTime();
            int turnaroundTime = waitingTime + p.getBurstTime();

            p.setWaitingTime(waitingTime);
            p.setTurnaroundTime(turnaroundTime);

            // Move time ahead after this process finishes
            currentTime += p.getBurstTime();
        }
    }

    // Method to display process table and averages
    public void display(List<FCFSProcess> processes) {
        System.out.printf("%-10s%-15s%-15s%-15s%-15s%n",
                "Process", "Arrival Time", "Burst Time", "Waiting Time", "Turnaround Time");

        for (FCFSProcess p : processes) {
            System.out.printf("%-10s%-15d%-15d%-15d%-15d%n",
                    p.getProcessId(), p.getArrivalTime(), p.getBurstTime(),
                    p.getWaitingTime(), p.getTurnaroundTime());
        }

        double avgWT = processes.stream()
                .mapToInt(FCFSProcess::getWaitingTime)
                .average()
                .orElse(0.0);

        double avgTAT = processes.stream()
                .mapToInt(FCFSProcess::getTurnaroundTime)
                .average()
                .orElse(0.0);

        System.out.printf("%nAverage Waiting Time: %.2f%n", avgWT);
        System.out.printf("Average Turnaround Time: %.2f%n", avgTAT);
    }
}

/**
 * Main class to run the FCFS Scheduler.
 */
public class FCFS_ALGO {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        List<FCFSProcess> processList = new ArrayList<>();

        // Input: Number of processes
        System.out.print("Enter number of processes: ");
        int n = scanner.nextInt();

        // Input: Process details
        for (int i = 0; i < n; i++) {
            System.out.print("\nEnter Process ID: ");
            String pid = scanner.next();

            System.out.print("Enter Arrival Time: ");
            int at = scanner.nextInt();

            System.out.print("Enter Burst Time: ");
            int bt = scanner.nextInt();

            processList.add(new FCFSProcess(pid, at, bt));
        }

        // Create Scheduler and execute FCFS
        Scheduler scheduler = new Scheduler();
        scheduler.calculateFCFS(processList);

        // Display results
        System.out.println("\n===== FCFS Scheduling Result =====");
        scheduler.display(processList);

        scanner.close();
    }
}
